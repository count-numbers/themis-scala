<div class="page-header">
	<h1>My Profile</h1>
</div>
<table class="key-value-table">
	<tbody>
		<tr>
			<td>Username</td>
			<td>{{profile.username}}</td>
		</tr>
		<tr>
			<td>Name</td>
			<td>{{profile.name}}</td>
		</tr>
		<tr>
			<td>Email</td>
			<td>{{profile.email}}</td>
		</tr>
		<tr>
			<td>Password</td>
			<td><button class="btn btn-default" data-toggle="modal" data-target="#passwordModal">Change</button></td>
		</tr>
	</tbody>
</table>

<div>

	<div class="panel panel-primary">
		<div class="panel-heading">GDrive Integration</div>
		<div class="panel-body">
			<div ng-switch="getGoogleAuthState()">
				<div ng-switch-when="skipped" class="alert alert-success"><strong>Success.</strong> Authorization to Google Drive was already granted. Re-using existing token.</div>
				<div ng-switch-when="success" class="alert alert-success"><strong>Success.</strong> Successfully authorized to access Google Drive account.</div>
				<div ng-switch-when="revoked" class="alert alert-success"><strong>Revoked.</strong> Revoked authorization to access Google Drive account.</div>
				<div ng-switch-when="error" class="alert alert-danger"><strong>Error.</strong> Access to Google Drive account not authorized.</div>
			</div>

			<a class="btn btn-primary" role="button" href="{{googleOAuthURL}}">Authorize Google</a>
			<a class="btn btn-primary" role="button" href="{{googleRevokeURL}}">Revoke authorization</a>

			<div>
				<h3>Contents of {{gdrive.folderName}}</h3>
				<dms-loading-indicator loading="gdrive.loading"></dms-loading-indicator>
				<div ng-show="!gdrive.folders.length && !gdrive.loading">(empty)</div>
				<ul class="list-group">
					<li ng-repeat="file in gdrive.folders" ng-click="gdrive.setFolder(file)" class="list-group-item">{{file.name}}</li>
				</ul>
			</div>

		</div>
	</div>

</div>


<!-- Modal -->
<div class="modal fade" id="passwordModal" tabindex="-1" role="dialog" aria-labelledby="passwordModalLabel">
	<div class="modal-dialog" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="passwordModalLabel">Change password for {{profile.username}}</h4>
			</div>
			<div class="modal-body">
				<dms-rest-error response="passwordError"></dms-rest-error>
				<form>
					<div>
						<input type="password" class="form-control" placeholder="Old password" ng-model="oldPassword"/>
					</div>
					<div class="skip-top-unrelated">
						<input type="password" class="form-control" placeholder="New password" ng-model="newPassword"/>
					</div>
					<div class="skip-top-related">
						<input type="password" class="form-control" placeholder="Repeat new password" ng-model="newPasswordRepeat" />
					</div>
					<div ng-hide="passwordsMatch()" class="alert alert-danger skip-top-related" >
						Passwords do not match
					</div>
				</form>
			</div>
			<div class="modal-footer">
			<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" ng-disabled="!canSubmit()" ng-click="changePassword()">Change password</button>
			</div>
		</div>
	</div>
</div>